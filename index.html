<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ClimaJá!</title>
  <link rel="icon" type="image/png" href="logo.png">

<script src="https://cmp.gatekeeperconsent.com/min.js" data-cfasync="false"></script>
<script src="https://the.gatekeeperconsent.com/cmp.min.js" data-cfasync="false"></script>
<script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
<script>
    window.ezstandalone = window.ezstandalone || {};
    ezstandalone.cmd = ezstandalone.cmd || [];
</script>
<meta name="keywords" content="ClimaJá, clima, umidade, temperatura, mapa tempo, clima tempo, climaja, site de clima, onde ver a temperatura, etc, meteorologia, monitoramento">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "ClimaJá",
  "url": "/",
  "description": "O ClimaJá! é uma plataforma colaborativa para monitoramento meteorológico e relatos de alagamentos em tempo real. O objetivo é ajudar pessoas a se informarem sobre as condições do clima e compartilharem informações úteis para a sociedade, promovendo segurança e prevenção",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://oclimaja.netlify.app/?q={search_term_string}",
    "query-input": "required name=search_term_string"
  },
  "contactPoint": {
    "@type": "ContactPoint",
    "contactType": "customer support",
    "email": "oclimaja@hotmail.com",
    "url": "mailto:oclimaja@hotmail.com",
    "availableLanguage": "Portuguese"
  }
}
</script>

  <!-- CSS externos -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/weather-icons/2.0.12/css/weather-icons.min.css">
  <!-- Nosso CSS -->
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="animacao-global.css">
  <style>
    /* Área de login/cadastro: visual moderno, espaçamento, gradiente, bordas arredondadas */
    .login-cadastro-area {
      display: flex;
      gap: 0.7rem;
      align-items: center;
      padding: 0.5rem 1.2rem;
      background: linear-gradient(90deg, #e0f2fe 60%, #f9f871 100%);
      border-radius: 1.2rem;
      box-shadow: 0 2px 12px #2563eb22;
      border: 2px solid #38bdf8;
      margin-right: 1.2rem;
      margin-top: 0.5rem;
      margin-bottom: 0.5rem;
    }
    .login-cadastro-area .btn {
      border-radius: 0.7rem;
      font-weight: 700;
      box-shadow: 0 2px 8px #2563eb11;
      transition: background 0.3s, color 0.3s, box-shadow 0.3s;
    }
    .login-cadastro-area .btn-outline-primary {
      background: #fff;
      color: #2563eb;
      border: 2px solid #38bdf8;
    }
    .login-cadastro-area .btn-outline-primary:hover {
      background: #bae6fd;
      color: #232946;
      box-shadow: 0 2px 12px #38bdf822;
    }
    .login-cadastro-area .btn-outline-light {
      background: #f9f871;
      color: #232946;
      border: 2px solid #fbbf24;
    }
    .login-cadastro-area .btn-outline-light:hover {
      background: #fbbf24;
      color: #fff;
      box-shadow: 0 2px 12px #fbbf2433;
    }
    @media (max-width: 600px) {
      .login-cadastro-area {
        flex-direction: column;
        gap: 0.4rem;
        padding: 0.3rem 0.5rem;
        margin-right: 0.2rem;
      }
    }
    /* Garante que a área de dados do perfil nunca muda de cor, nem em hover, focus ou active */
    #perfil-dados.dropdown-item,
    #perfil-dados.dropdown-item:hover,
    #perfil-dados.dropdown-item:focus,
    #perfil-dados.dropdown-item:active {
      background: inherit !important;
      color: inherit !important;
      cursor: default;
      box-shadow: none !important;
    }
    /* Não aplicar hover na área de dados do perfil */
    #perfil-dados.dropdown-item:hover {
      background: inherit !important;
      color: inherit !important;
      cursor: default;
    }
    /* Perfil Dropdown: Gradiente, bordas arredondadas, paleta azul/aqua/amarelo */
    .dropdown-menu[aria-labelledby="perfilDropdown"] {
      background: #fff;
      border-radius: 1.5rem;
      box-shadow: 0 8px 32px -8px #2563eb44, 0 0 40px 0 #5ee7df33 inset;
      border: 2px solid #38bdf8;
      padding: 1.2rem 1rem 1rem 1rem;
      animation: sobreFadeIn 0.8s cubic-bezier(.23,1.02,.32,1) both;
    }
    .dropdown-menu[aria-labelledby="perfilDropdown"] .dropdown-item {
      border-radius: 1rem;
      margin-bottom: 0.5rem;
      background: rgba(255,255,255,0.85);
      color: #232946;
      font-weight: 600;
      transition: background 0.3s, color 0.3s;
    }
    .dropdown-menu[aria-labelledby="perfilDropdown"] .dropdown-item:hover {
      background: rgba(56, 189, 248, 0.09); /* azul claro, ainda mais transparente */
      color: #2563eb;
    }
    #perfil-dados {
      background: linear-gradient(120deg, #e0f2fe 60%, #f9f871 100%);
      border-radius: 1.2rem;
      box-shadow: 0 2px 12px #2563eb22;
      padding: 1rem 0.5rem 0.7rem 0.5rem;
      margin-bottom: 0.7rem;
    }
    #perfil-dados img {
      border: 3px solid #38bdf8;
      box-shadow: 0 2px 12px #5ee7df44;
    }
    #perfil-nome {
      color: #2563eb;
      font-weight: 800;
      font-size: 1.3rem;
      text-shadow: 0 2px 8px #bae6fd99;
    }
    #perfil-email {
      color: #3a506b;
      font-size: 1rem;
      font-weight: 500;
    }
    .badge.bg-primary {
      background: linear-gradient(90deg, #38bdf8 60%, #f9f871 100%);
      color: #232946;
      font-weight: 700;
      border-radius: 0.7rem;
      box-shadow: 0 2px 8px #2563eb22;
    }
    #logout-btn {
      border-radius: 0.7rem;
      font-weight: 700;
      background: linear-gradient(90deg, #f87171 60%, #fbbf24 100%);
      color: #232946;
      border: none;
      box-shadow: 0 2px 8px #f8717133;
      transition: background 0.3s, color 0.3s;
    }
    #logout-btn:hover {
      background: linear-gradient(90deg, #fbbf24 60%, #f87171 100%);
      color: #fff;
    }
    @media (max-width: 600px) {
      .dropdown-menu[aria-labelledby="perfilDropdown"] {
        min-width: 90vw;
        padding: 1.1rem 0.3rem 1rem 0.3rem;
      }
      #perfil-dados {
        padding: 0.7rem 0.2rem 0.5rem 0.2rem;
      }
    }
    [data-theme="dark"] .dropdown-menu[aria-labelledby="perfilDropdown"] {
      background: linear-gradient(120deg, #1e293b 60%, #0f172a 100%) !important;
      color: #f8fafc !important;
      border-color: #60a5fa;
    }
    [data-theme="dark"] #perfil-dados {
      background: linear-gradient(120deg, #334155 60%, #1e293b 100%) !important;
      color: #f8fafc !important;
      border-color: #60a5fa;
    }
    [data-theme="dark"] #perfil-nome {
      color: #60a5fa !important;
      text-shadow: 0 2px 8px #0f172a99;
    }
    [data-theme="dark"] #perfil-email {
      color: #f8fafc !important;
    }
    [data-theme="dark"] .badge.bg-primary {
      background: linear-gradient(90deg, #60a5fa 60%, #f9f871 100%) !important;
      color: #232946 !important;
    }
    [data-theme="dark"] #logout-btn {
      background: linear-gradient(90deg, #f87171 60%, #fbbf24 100%) !important;
      color: #232946 !important;
    }
    [data-theme="dark"] #logout-btn:hover {
      background: linear-gradient(90deg, #fbbf24 60%, #f87171 100%) !important;
      color: #fff !important;
    }
  </style>
  <style>
    /* HEADER: degradê surpreendente, harmônico e temático (clima/meteorologia) */
    .main-header {
      /* Fundo: gradiente multicolorido com "aurora boreal" + "céu" + "chuva" + "sol" */
      background: linear-gradient(120deg,
        #232946 0%,      /* noite/aurora escura */
        #3a506b 10%,     /* azul petróleo/frio */
        #5ee7df 22%,     /* verde água/aurora */
        #b3e0ff 35%,     /* azul claro/inverno */
        #f9f871 55%,     /* amarelo sol */
        #fbbf24 65%,     /* dourado quente */
        #fca5a5 75%,     /* rosa/aurora */
        #a5b4fc 85%,     /* lilás/chuva */
        #232946 100%     /* noite/aurora escura */
      );
      background-size: 300% 300%;
      animation: gradienteAnimado 16s ease-in-out infinite alternate;
    @keyframes gradienteAnimado {
      0% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
      100% {
        background-position: 0% 50%;
      }
    }
      background-size: 300% 300%;
      animation: gradienteAnimado 16s ease-in-out infinite alternate;
      color: #fff;
      box-shadow: 0 8px 32px -8px #2563eb44, 0 0 120px 0 #5ee7df33 inset;
      padding: 2.2rem 1.2rem 1.5rem 1.2rem;
      margin-bottom: 2.5rem;
      display: flex;
      align-items: center;
      gap: 2rem;
      justify-content: center;
      flex-wrap: wrap;
      border-radius: 0 0 2.5rem 2.5rem;
      border: 2px solid #38bdf8;
      position: relative;
      overflow: hidden;
      transition: background 0.7s;
      /* Efeito "neblina"/"aurora" animada */
      isolation: isolate;
    }

    @keyframes gradienteAnimado {
      0% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
      100% {
        background-position: 0% 50%;
      }
    }
    .main-header::before {
      content: "";
      position: absolute;
      inset: 0;
      z-index: 0;
      pointer-events: none;
      background: radial-gradient(ellipse 80% 40% at 60% 0%, #f9f87155 0%, #fbbf2433 40%, transparent 100%),
                  radial-gradient(ellipse 60% 30% at 20% 20%, #5ee7df44 0%, #a5b4fc33 60%, transparent 100%),
                  radial-gradient(ellipse 40% 20% at 80% 80%, #fca5a522 0%, transparent 100%);
      opacity: 0.85;
      animation: auroraMove 12s ease-in-out infinite alternate;
    }
    @keyframes auroraMove {
      0% { background-position: 60% 0%, 20% 20%, 80% 80%; }
      100% { background-position: 50% 10%, 30% 30%, 70% 70%; }
    }
    .main-header::after {
      /* Efeito "chuva" sutil */
      content: "";
      position: absolute;
      inset: 0;
      z-index: 1;
      pointer-events: none;
      background-image: repeating-linear-gradient(120deg, #fff2 0 2px, transparent 2px 20px);
      opacity: 0.13;
      animation: chuvaMove 7s linear infinite;
    }
    @keyframes chuvaMove {
      0% { background-position: 0 0; }
      100% { background-position: 60px 60px; }
    }
    .main-header > * {
      position: relative;
      z-index: 2;
    }
    /* Remove degradês individuais, agora é um só harmônico */
    .main-header .logo-box {
      background: none; /* Remove o fundo branco */
      border-radius: 1.5rem;
      box-shadow: 0 2px 12px #2563eb22;
      padding: 0.4rem 1.1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 170px; /* Aumenta ainda mais a altura */
      width: 200px;  /* Aumenta bastante a largura */
      transition: transform 0.3s;
    }
    .main-header img {
      height: 140px; /* Aumenta ainda mais a logo */
      width: 180px;  /* Deixa a logo mais larga */
      object-fit: contain;
      border-radius: 1rem;
      background: none;
      box-shadow: none;
      padding: 0;
      transition: transform 0.3s;
    }
    .main-header .project-title {
      font-size: 3.7rem; /* Título ainda maior */
      font-weight: 900;
      letter-spacing: 2.5px;
      margin-bottom: 0.4rem;
      color: #fff;
      text-shadow: 0 2px 12px #2563eb44;
    }
    .main-header .project-desc {
      font-size: 2rem; /* Subtítulo maior */
      font-weight: 600;
      opacity: 0.98;
      color: #e0e7ff;
    }
    /* Ajuste para o container do mapa */
    #map {
      min-height: 350px;
      height: 60vh;
      border-radius: 1rem;
      border: 1.5px solid var(--primary);
      background: var(--card-bg);
      box-shadow: 0 2px 12px #2563eb22;
      margin-bottom: 1rem;
    }
    /* Animações para login/cadastro */
    .fade-in {
      animation: fadeInLogin 0.5s;
    }
    .fade-out {
      animation: fadeOutLogin 0.4s forwards;
    }
    @keyframes fadeInLogin {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: none; }
    }
    @keyframes fadeOutLogin {
      from { opacity: 1; }
      to { opacity: 0; transform: translateY(-20px); }
    }
    .form-control:invalid {
      border-color: #dc2626;
      box-shadow: 0 0 0 2px #dc262622;
    }
    .form-control:valid {
      border-color: #22c55e;
      box-shadow: 0 0 0 2px #22c55e22;
    }
    .form-feedback {
      font-size: 0.95rem;
      color: #dc2626;
      margin-top: -0.7rem;
      margin-bottom: 0.7rem;
      display: none;
    }
    .form-feedback.active {
      display: block;
    }
    /* Animação para o quadro Sobre o Projeto e Clima */
    .main-card.sobre-anim, .main-card.clima-anim {
      animation: sobreFadeIn 1.1s cubic-bezier(.23,1.02,.32,1) both;
      box-shadow: 0 8px 32px -8px #2563eb33, 0 1.5px 12px #38bdf822;
      border: 2px solid #38bdf8;
      background: linear-gradient(120deg, #f0f9ff 60%, #e0f2fe 100%);
      transition: box-shadow 0.4s, border 0.4s, background 0.4s, transform 0.35s cubic-bezier(.23,1.02,.32,1);
    }
    .tab-pane#clima .main-card.clima-anim {
      cursor: pointer;
      transition: box-shadow 0.4s, border 0.4s, background 0.4s, transform 0.35s cubic-bezier(.23,1.02,.32,1);
    }
    .tab-pane#clima .main-card.clima-anim:hover {
      transform: scale(1.045) translateY(-8px);
      box-shadow: 0 20px 56px -8px #2563eb55, 0 8px 32px #38bdf855;
      border-color: #2563eb;
      background: linear-gradient(120deg, #e0f2fe 60%, #bae6fd 100%);
    }
    @keyframes sobreFadeIn {
      0% {
        opacity: 0;
        transform: scale(0.97) translateY(40px) skewY(2deg);
        filter: blur(6px);
      }
      60% {
        opacity: 1;
        filter: blur(0.5px);
      }
      100% {
        opacity: 1;
        transform: scale(1) translateY(0) skewY(0);
        filter: blur(0);
      }
    }
    @media (max-width: 600px) {
      .main-header {
        flex-direction: column;
        gap: 0.7rem;
        padding: 1.1rem 0.3rem 1.1rem 0.3rem;
      }
      .main-header .logo-box {
        height: 80px;
        width: 110px;
        padding: 0.2rem 0.7rem;
        border-radius: 1.1rem;
      }
      .main-header img {
        height: 60px;
        width: 90px;
        border-radius: 0.7rem;
      }
      .main-header .project-title {
        font-size: 1.7rem;
      }
      .main-header .project-desc {
        font-size: 1.15rem;
      }
      .container.my-4 {
        padding-left: 0.2rem;
        padding-right: 0.2rem;
      }
    }
    [data-theme="dark"] .main-card.sobre-anim, [data-theme="dark"] .main-card.clima-anim {
      background: linear-gradient(120deg, #1e293b 60%, #0f172a 100%) !important;
      color: #f8fafc !important;
      border-color: #60a5fa;
    }
    [data-theme="dark"] .main-card.sobre-anim h2,
    [data-theme="dark"] .main-card.sobre-anim p,
    [data-theme="dark"] .main-card.clima-anim h2,
    [data-theme="dark"] .main-card.clima-anim p,
    [data-theme="dark"] .main-card.clima-anim .weather-header,
    [data-theme="dark"] .main-card.clima-anim .weather-item,
    [data-theme="dark"] .main-card.clima-anim .sensor-value {
      color: #f8fafc !important;
      text-shadow: 0 2px 8px #0f172a99;
    }
    [data-theme="dark"] .main-card.clima-anim .weather-item {
      background: #1e293bcc !important;
      border-color: #334155 !important;
    }
    [data-theme="dark"] .main-card.clima-anim .weather-icon {
      color: #60a5fa !important;
      filter: drop-shadow(0 2px 8px #60a5fa33);
    }
    .footer-logo-img {
      height: 48px;
      width: auto;
      max-width: 120px;
      object-fit: contain;
      background: transparent;
      border-radius: 0.7rem;
      transition: background 0.3s;
      box-shadow: 0 2px 8px #2563eb11;
      padding: 2px 8px;
    }
    [data-theme="dark"] .footer-logo-img {
      background: #fff;
    }
  </style>
</head>
<body>
  <!-- Botão de modo escuro removido -->

  <header class="main-header">
    <div class="logo-box">
      <img src="logo.png" alt="Logo ClimaJá!">
    </div>
    <div>
      <div class="project-title">ClimaJá!</div>
      <div class="project-desc">Monitoramento Meteorológico e Relatos de Alagamentos em Tempo Real</div>
    </div>
   <!-- ...código anterior... -->
<div class="d-flex justify-content-end align-items-center pe-3" style="position:absolute;top:1.5rem;right:0;z-index:10;">
  <!-- Botão de perfil substitui login/cadastro quando logado -->
  <div id="perfil-area" class="d-none">
    <div class="dropdown">
      <button class="btn btn-gradient btn-sm fw-bold dropdown-toggle d-flex align-items-center" type="button" id="perfilDropdown" data-bs-toggle="dropdown" aria-expanded="false">
        <img src="logo.png" alt="Avatar" style="width:32px;height:32px;border-radius:50%;margin-right:8px;box-shadow:0 2px 8px #2563eb22;">
        <span id="perfil-nome-area" style="font-weight:600;">Perfil</span>
      </button>
      <ul class="dropdown-menu" aria-labelledby="perfilDropdown" style="min-width:260px;border-radius:0;">
        <li>
          <div class="dropdown-item text-center" id="perfil-dados" style="min-width:220px;padding-bottom:10px;">
            <img src="logo.png" alt="Avatar" style="width:72px;height:72px;border-radius:50%;box-shadow:0 2px 8px #2563eb22;margin-bottom:10px;">
            <div style="font-size:1.25rem;font-weight:800;color:#2563eb;margin-bottom:2px;" id="perfil-nome">-</div>
            <div style="font-size:1rem;color:#555;margin-bottom:8px;" id="perfil-email">-</div>
            <span class="badge bg-primary mb-2" style="font-size:0.9rem;">Usuário ClimaJá!</span>
            <hr style="margin:10px 0 6px 0;">
            <button class="btn btn-danger btn-sm fw-bold w-100" id="logout-btn" type="button">
              <i class="fas fa-sign-out-alt me-1"></i>Sair
            </button>
          </div>
        </li>
        <li><hr class="dropdown-divider"></li>
        <li><a class="dropdown-item" href="#" id="perfil-relatos"><i class="fas fa-list me-1 text-primary"></i>Meus Relatos</a></li>
        <li><a class="dropdown-item" href="#" id="perfil-editar"><i class="fas fa-user-edit me-1 text-success"></i>Editar Perfil</a></li>
        <li><a class="dropdown-item" href="#" id="perfil-ajuda"><i class="fas fa-question-circle me-1 text-info"></i>Ajuda</a></li>
        <li><hr class="dropdown-divider"></li>
        <li><hr class="dropdown-divider"></li>
      </ul>
    </div>
  </div>
  <a class="btn btn-outline-primary btn-sm fw-bold me-2" id="cadastrar-btn" href="register.html">
    <i class="fas fa-user-plus me-1"></i>Cadastrar
  </a>
  <a class="btn btn-outline-light btn-sm fw-bold" id="entrar-btn" href="login.html">
    <i class="fas fa-sign-in-alt me-1"></i>Entrar
  </a>
</div>
<!-- Controle de autenticação e exibição do perfil/relato é feito apenas pelo script.js -->
<!-- ...código seguinte... -->
  </header>

  <div class="container my-4">
    <ul class="nav nav-pills justify-content-center mb-4">
      <li class="nav-item">
        <a class="nav-link active" data-bs-toggle="pill" href="#projeto">
          <i class="fas fa-info-circle me-2"></i>Sobre o Projeto
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-bs-toggle="pill" href="#mapa">
          <i class="fas fa-map me-2"></i>Mapa
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-bs-toggle="pill" href="#clima">
          <i class="fas fa-sun me-2"></i>Clima
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-bs-toggle="pill" href="#relatar" id="aba-relatar">
          <i class="fas fa-edit me-2"></i>Relatar
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-bs-toggle="pill" href="#sobre">
          <i class="fas fa-user me-2"></i>Sobre Nós
        </a>
      </li>
      <li class="nav-item" id="nav-login-item">
        <!-- Área de perfil: só aparece para logados -->
        <div id="perfil-area" class="d-none">
          <div class="dropdown">
            <button class="btn btn-gradient btn-sm fw-bold dropdown-toggle" type="button" id="perfilDropdown" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="fas fa-user-circle me-1"></i>
              <span id="perfil-nome-area">Perfil</span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="perfilDropdown">
              <li>
            <div class="dropdown-item" id="perfil-dados">
              <div><strong>Email:</strong> <span id="perfil-email">-</span></div>
              <div><strong>Nome:</strong> <span id="perfil-nome">-</span></div>
                </div>
              </li>
              <li><a class="dropdown-item" href="#" id="perfil-relatos">Meus Relatos</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item text-danger" href="#" id="logout-btn"><i class="fas fa-sign-out-alt me-1"></i>Sair</a></li>
            </ul>
          </div>
        </div>
      </li>
    </ul>

    <div class="tab-content">
      <!-- === Aba Projeto (principal) === -->
      <div class="tab-pane fade show active" id="projeto">
        <div class="main-card text-center animada">
          <h2 class="mb-3"><i class="fas fa-info-circle me-2"></i>Sobre o Projeto</h2>
          <p class="mb-3">O <strong>ClimaJá!</strong> é uma plataforma colaborativa para monitoramento meteorológico e relatos de alagamentos em tempo real. O objetivo é ajudar pessoas a se informarem sobre as condições do clima e compartilharem informações úteis para a sociedade, promovendo segurança e prevenção.</p>
          <p class="mb-3">Aqui você pode visualizar o mapa de alagamentos, consultar dados climáticos atualizados e relatar ocorrências de forma simples e rápida, contribuindo para uma cidade mais resiliente.</p>
        </div>
      </div>
      <!-- === Aba Sobre Nós === -->
      <div class="tab-pane fade" id="sobre">
        <div class="main-card text-center animada">
          <h2 class="mb-3"><i class="fas fa-user me-2"></i>Sobre Nós</h2>
          <img src="logo.png" alt="Avatar" style="width:80px;height:80px;border-radius:50%;box-shadow:0 2px 8px #2563eb22;margin-bottom:1rem;">
          <p class="mb-1">Olá! Nós somos da <strong>Escola Técnica Estadual Ginásio Pernambucano</strong>, uma equipe apaixonada por tecnologia, meteorologia e soluções inovadoras para a sociedade. O ClimaJá! foi criado para ajudar pessoas a monitorar o clima e compartilhar informações importantes sobre alagamentos em tempo real.</p>
          <!-- Ícones de email e LinkedIn removidos -->
          <p class="text-muted small">Entre em contato: <a href="mailto:oclimaja@hotmail.com">oclimaja@hotmail.com</a></p>
        </div>
      </div>
      <!-- === Aba Mapa === -->
      <div class="tab-pane fade" id="mapa">
        <div class="main-card animada">
          <div id="map"></div>
          <div class="mt-3 text-center">
            <button class="btn btn-modern" onclick="locateUser(true)">
              <i class="fas fa-location-crosshairs me-2"></i>Minha Localização
            </button>
          </div>
        </div>
      </div>
      <!-- === Aba Clima === -->
      <div class="tab-pane fade" id="clima">
        <div class="main-card animada">
          <div class="weather-header">
            <i class="wi wi-day-sunny weather-icon"></i>
            <div>
              <h2 class="mb-0" id="city-name">Carregando...</h2>
              <div class="sensor-value" id="current-temp">--°C</div>
            </div>
          </div>
          <div class="weather-grid">
            <div class="weather-item">
              <i class="wi wi-humidity"></i>
              <div class="mt-2">
                <div class="text-muted small">Umidade</div>
                <div class="fw-bold" id="humidity">--%</div>
              </div>
            </div>
            <div class="weather-item">
              <i class="wi wi-rain"></i>
              <div class="mt-2">
                <div class="text-muted small">Chuva</div>
                <div class="fw-bold" id="rain">--mm</div>
              </div>
            </div>
            <div class="weather-item">
              <i class="wi wi-strong-wind"></i>
              <div class="mt-2">
                <div class="text-muted small">Vento</div>
                <div class="fw-bold" id="wind-speed">--km/h</div>
              </div>
            </div>
            <div class="weather-item">
              <i class="wi wi-barometer"></i>
              <div class="mt-2">
                <div class="text-muted small">Pressão</div>
                <div class="fw-bold" id="pressure">--hPa</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- === Aba Relatar === -->
      <div class="tab-pane fade" id="relatar">
        <div class="main-card animada" id="relato-area">
          <ul class="nav nav-tabs mb-3" id="tipoRelatoTabs" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="pedestre-tab" data-bs-toggle="tab" data-bs-target="#relato-pedestre" type="button" role="tab" aria-controls="relato-pedestre" aria-selected="true">Pedestre</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="motorista-tab" data-bs-toggle="tab" data-bs-target="#relato-motorista" type="button" role="tab" aria-controls="relato-motorista" aria-selected="false">Motorista</button>
            </li>
          </ul>
          <div class="tab-content">
            <div class="tab-pane fade show active" id="relato-pedestre" role="tabpanel" aria-labelledby="pedestre-tab">
              <form id="reportForm">
                <input type="hidden" id="latitude" name="latitude">
                <input type="hidden" id="longitude" name="longitude">
                <div class="mb-3">
                  <label for="address" class="form-label">Endereço do Ocorrido</label>
                  <input type="text" class="form-control" id="address" placeholder="Digite o endereço completo ou selecione no mapa" required autocomplete="off">
                  <div id="address-suggestions" class="dropdown-menu" style="width:100%"></div>
                  <small class="form-text text-muted">Exemplo: Rua Exemplo, 123, Bairro, Cidade</small>
                </div>
                <div class="mb-3">
                  <label for="ocorrido-primario" class="form-label">Ocorrido Primário</label>
                  <select class="form-select" id="ocorrido-primario" required>
                    <option value="">Selecione</option>
                    <option value="alagamento">💧 Alagamento</option>
                    <option value="enxurrada">🌊 Enxurrada</option>
                    <option value="obstrucao">🚧 Obstrução de via</option>
                    <option value="deslizamento">⛰️ Deslizamento</option>
                    <option value="fio-duvidoso">⚡ Fio duvidoso</option>
                    <option value="outro">❓ Outro</option>
                  </select>
                </div>
                <div class="mb-3">
                  <label for="ocorrido-secundario" class="form-label">Ocorrido Secundário <span class="text-muted" style="font-weight:400;">(opcional)</span></label>
                  <select class="form-select" id="ocorrido-secundario">
                    <option value="">Nenhum</option>
                    <option value="alagamento">💧 Alagamento</option>
                    <option value="enxurrada">🌊 Enxurrada</option>
                    <option value="obstrucao">🚧 Obstrução de via</option>
                    <option value="deslizamento">⛰️ Deslizamento</option>
                    <option value="fio-duvidoso">⚡ Fio duvidoso</option>
                    <option value="outro">❓ Outro</option>
                  </select>
                </div>
                <div class="mb-3">
                  <label for="water-level" class="form-label">Nível da Água</label>
                  <select class="form-select" id="water-level" required>
                    <option value="">Selecione</option>
                    <option value="0">Sem água no momento</option>
                    <option value="0.2">Até o tornozelo (baixo)</option>
                    <option value="0.5">Até o joelho (moderado)</option>
                    <option value="1.0">Até a cintura (alto)</option>
                    <option value="1.5">Acima da cintura (grave)</option>
                  </select>
                </div>
                <div class="mb-3">
                  <label for="descricao" class="form-label">Descrição detalhada <span class="text-muted" style="font-weight:400;">(opcional)</span></label>
                  <textarea class="form-control" id="descricao" rows="3" placeholder="Descreva o que aconteceu, pontos de referência, impactos, etc."></textarea>
                  <small class="form-text text-muted">Inclua detalhes como horário, danos, pessoas afetadas, etc.</small>
                </div>
                <div class="mb-3">
                  <label for="data-hora" class="form-label">Data e Hora do Evento</label>
                  <input type="hidden" class="form-control" id="data-hora" name="data-hora">
                </div>
                <div class="mb-3">
                  <label for="flood-photo" class="form-label">Fotos (opcional, até 3)</label>
                  <input type="file" class="form-control" id="flood-photo" accept="image/*" multiple>
                  <small class="form-text text-muted">Você pode anexar até 3 fotos do local.</small>
                </div>
                <button type="submit" class="btn btn-modern">Enviar Relato</button>
              </form>
            </div>
            <div class="tab-pane fade" id="relato-motorista" role="tabpanel" aria-labelledby="motorista-tab">
              <form id="reportFormMotorista">
                <input type="hidden" id="latitude-motorista" name="latitude">
                <input type="hidden" id="longitude-motorista" name="longitude">
                <div class="mb-3">
                  <label for="address-motorista" class="form-label">Endereço do Ocorrido</label>
                  <input type="text" class="form-control" id="address-motorista" placeholder="Digite o endereço completo ou selecione no mapa" required autocomplete="off">
                  <div id="address-suggestions-motorista" class="dropdown-menu" style="width:100%"></div>
                  <small class="form-text text-muted">Exemplo: Rua Exemplo, 123, Bairro, Cidade</small>
                </div>
                <div class="mb-3">
                  <label for="veiculo" class="form-label">Veículo</label>
                  <input type="text" class="form-control" id="veiculo" placeholder="Marca e modelo do veículo" required>
                </div>
                <div class="mb-3">
                  <label for="nivel-submersao" class="form-label">Nível de Submersão</label>
                  <select class="form-select" id="nivel-submersao" required>
                    <option value="">Selecione</option>
                    <option value="0">Sem água no momento</option>
                    <option value="0.2">Até a metade da roda</option>
                    <option value="0.5">Até a porta</option>
                    <option value="1.0">Acima da porta</option>
                  </select>
                </div>
                <div class="mb-3">
                  <label for="descricao-motorista" class="form-label">Descrição detalhada <span class="text-muted" style="font-weight:400;">(opcional)</span></label>
                  <textarea class="form-control" id="descricao-motorista" rows="3" placeholder="Descreva o que aconteceu, pontos de referência, impactos, etc."></textarea>
                  <small class="form-text text-muted">Inclua detalhes como horário, danos, pessoas afetadas, etc.</small>
                </div>
                <div class="mb-3">
                  <label for="data-hora-motorista" class="form-label">Data e Hora do Evento</label>
                  <input type="hidden" class="form-control" id="data-hora-motorista" name="data-hora">
                </div>
                <div class="mb-3">
                  <label for="flood-photo-motorista" class="form-label">Fotos (opcional, até 3)</label>
                  <input type="file" class="form-control" id="flood-photo-motorista" accept="image/*" multiple>
                  <small class="form-text text-muted">Você pode anexar até 3 fotos do local.</small>
                </div>
                <button type="submit" class="btn btn-modern">Enviar Relato</button>
              </form>
            </div>
          </div>
        </div>
        <div id="relato-login-msg" class="text-center my-3 d-none">
          <div class="alert alert-warning d-inline-block px-4 py-2" style="font-size:1.1rem;">
            <i class="fas fa-lock me-2"></i>Você precisa estar logado para enviar um relato.<br>
          </div>
        </div>
        <div id="relatos-publicos" class="mt-4">
          <!-- Relatos públicos serão exibidos aqui via JS -->
        </div>
      </div>
    

  <footer class="bg-light py-4 mt-5 border-top" style="transition:background 0.3s;">
    <div class="container text-center">
      <h5 class="mb-2"><i class="fas fa-cloud-sun me-2"></i>ClimaJá! &copy; 2025</h5>
      <p class="mb-1">Projeto de monitoramento meteorológico e relatos de alagamentos. Desenvolvido por Escola Técnica Estadual Ginásio Pernambucano.</p>
      <div class="mb-2">
        <!-- Removido: links github, linkedin, twitter -->
      </div>
      <div class="d-flex justify-content-center align-items-center gap-4 my-3">
        <img src="cria.png" alt="Logo CRIA" class="footer-logo-img" loading="lazy">
        <img src="clube.png" alt="Logo Clube" class="footer-logo-img" loading="lazy">
      </div>
      <p class="text-muted small">Entre em contato: <a href="mailto:oclimaja@hotmail.com">oclimaja@hotmail.com</a></p>
    </div>
  </footer>

  <!-- JS externos -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="./paranoid-security.js"></script>
  <!-- Nosso JS -->
  <script type="module" src="script.js"></script>
  <!-- Firebase SDK -->
<!-- Firebase removido temporariamente -->
  <script>
    // Firebase removido temporariamente
    // ...código anterior...
    // Funções de clima e mapa permanecem iguais
    // Localização global do usuário
    let userLocation = null;

    // Solicita localização ao carregar o site
    function pedirLocalizacaoInicial() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(pos) {
          userLocation = {
            lat: pos.coords.latitude,
            lon: pos.coords.longitude
          };
          // Usar localização para clima e mapa
          atualizarClimaComLocalizacao();
          centralizarMapaNaLocalizacao();
        }, function() {
          // Usuário negou ou erro
          userLocation = null;
        });
      }
    }

    // Atualiza aba Clima com localização
    function atualizarClimaComLocalizacao() {
      if (!userLocation) return;
      // Buscar bairro via Nominatim
      fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${userLocation.lat}&lon=${userLocation.lon}&addressdetails=1`)
        .then(res => res.json())
        .then(addrData => {
          let bairro = 'Localização';
          if (addrData && addrData.address) {
            bairro = addrData.address.suburb || addrData.address.neighbourhood || addrData.address.village || addrData.address.town || addrData.address.city || 'Localização';
          }
          // Buscar clima
          fetch(`https://api.open-meteo.com/v1/forecast?latitude=${userLocation.lat}&longitude=${userLocation.lon}&current_weather=true`)
            .then(res => res.json())
            .then(data => {
              if (data && data.current_weather) {
                document.getElementById('current-temp').textContent = `${data.current_weather.temperature}°C`;
                document.getElementById('city-name').textContent = bairro;
                document.getElementById('humidity').textContent = data.current_weather.relative_humidity ? `${data.current_weather.relative_humidity}%` : '--%';
                document.getElementById('wind-speed').textContent = `${data.current_weather.windspeed} km/h`;
                document.getElementById('pressure').textContent = data.current_weather.pressure ? `${data.current_weather.pressure} hPa` : '--';
                document.getElementById('rain').textContent = data.current_weather.precipitation ? `${data.current_weather.precipitation} mm` : '--mm';
              }
            });
        });
    }

    // Centraliza o mapa na localização do usuário
    function centralizarMapaNaLocalizacao() {
      if (!userLocation || !window.meuMapa) return;
      window.meuMapa.setView([userLocation.lat, userLocation.lon], 15);
      if (!window.userMarker) {
        window.userMarker = L.marker([userLocation.lat, userLocation.lon], {icon: L.icon({iconUrl: 'user-marker.png', iconSize: [32,32]})}).addTo(window.meuMapa);
      } else {
        window.userMarker.setLatLng([userLocation.lat, userLocation.lon]);
      }
    }

    // Função para localizar usuário via botão no mapa
    function locateUser(btn) {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(pos) {
          userLocation = {
            lat: pos.coords.latitude,
            lon: pos.coords.longitude
          };
          centralizarMapaNaLocalizacao();
        });
      }
    }

    // Função para preencher o campo de endereço com a localização atual ao abrir a aba Relatar
    function preencherEnderecoAtual() {
      const addressInput = document.getElementById('address');
      const latInput = document.getElementById('latitude');
      const lonInput = document.getElementById('longitude');
      if (!addressInput) return;
      if (userLocation) {
        latInput.value = userLocation.lat;
        lonInput.value = userLocation.lon;
        fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${userLocation.lat}&lon=${userLocation.lon}&addressdetails=1`)
          .then(res => res.json())
          .then(data => {
            if (data && data.display_name) {
              addressInput.value = data.display_name;
            }
          });
      } else if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(pos) {
          latInput.value = pos.coords.latitude;
          lonInput.value = pos.coords.longitude;
          fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${pos.coords.latitude}&lon=${pos.coords.longitude}&addressdetails=1`)
            .then(res => res.json())
            .then(data => {
              if (data && data.display_name) {
                addressInput.value = data.display_name;
              }
            });
        });
      }
    }

    // Função para preencher o campo de endereço com a localização atual ao abrir a aba Relatar
    function preencherEnderecoAtual() {
      const addressInput = document.getElementById('address');
      const latInput = document.getElementById('latitude');
      const lonInput = document.getElementById('longitude');
      if (!addressInput || !navigator.geolocation) return;
      navigator.geolocation.getCurrentPosition(function(pos) {
        const lat = pos.coords.latitude;
        const lon = pos.coords.longitude;
        if (latInput) latInput.value = lat;
        if (lonInput) lonInput.value = lon;
        fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&addressdetails=1`)
          .then(res => res.json())
          .then(data => {
            if (data && data.display_name) {
              addressInput.value = data.display_name;
            }
          });
      });
    }

    document.addEventListener('DOMContentLoaded', function() {
      // Solicita localização ao abrir o site
      pedirLocalizacaoInicial();

      // Preencher automaticamente ao abrir aba Relatar
      document.querySelectorAll('a[data-bs-toggle="pill"]').forEach(function(tab) {
        tab.addEventListener('shown.bs.tab', function (e) {
          if (e.target.getAttribute('href') === '#relatar') {
            preencherEnderecoAtual();
          }
          if (e.target.getAttribute('href') === '#clima') {
            atualizarClimaComLocalizacao();
          }
          if (e.target.getAttribute('href') === '#mapa') {
            inicializarMapaLeaflet();
            centralizarMapaNaLocalizacao();
          }
        });
      });

      // Inicializa o mapa Leaflet se não existir
      function inicializarMapaLeaflet() {
        if (window.meuMapa) return;
        const mapDiv = document.getElementById('map');
        if (!mapDiv) return;
        window.meuMapa = L.map('map').setView([-8.05, -34.9], 12); // Recife como padrão
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
          attribution: '© OpenStreetMap contributors'
        }).addTo(window.meuMapa);
      }
      // Relatos locais (em memória) - agora global
      window.relatosLocais = window.relatosLocais || [];
      const reportForm = document.getElementById('reportForm');
      if (reportForm) {
        reportForm.addEventListener('submit', function(e) {
          e.preventDefault();
          // Coleta dados do formulário
          const latitude = document.getElementById('latitude').value;
          const longitude = document.getElementById('longitude').value;
          const address = document.getElementById('address').value;
          const ocorridoPrimario = document.getElementById('ocorrido-primario').value;
          const ocorridoSecundario = document.getElementById('ocorrido-secundario').value;
          const nivel = document.getElementById('water-level').value;
          const descricao = document.getElementById('descricao').value;
          const dataHora = new Date().toISOString();
          let fotos = [];
          const photoInput = document.getElementById('flood-photo');
          if (photoInput && photoInput.files.length > 0) {
            for (let i = 0; i < Math.min(photoInput.files.length, 3); i++) {
              const file = photoInput.files[i];
              fotos.push(file.name);
            }
          }
          // Adiciona relato localmente (global)
          window.relatosLocais.unshift({
            latitude,
            longitude,
            address,
            ocorridoPrimario,
            ocorridoSecundario,
            nivel,
            descricao,
            dataHora,
            fotos,
            status: 'publico'
          });
          // Troca para a aba do mapa para mostrar o marcador
          const mapaTab = document.querySelector('a[href="#mapa"]');
          if (mapaTab) {
            var tab = new bootstrap.Tab(mapaTab);
            tab.show();
            // Aguarda a aba do mapa ser exibida antes de atualizar os marcadores
            setTimeout(function() {
              if (typeof inicializarMapaLeaflet === 'function') {
                inicializarMapaLeaflet();
              }
              if (window.meuMapa) {
                window.meuMapa.invalidateSize();
              }
              carregarRelatosPublicos();
            }, 350);
          } else {
            if (typeof inicializarMapaLeaflet === 'function') {
              inicializarMapaLeaflet();
            }
            if (window.meuMapa) {
              window.meuMapa.invalidateSize();
            }
            carregarRelatosPublicos();
          }
          alert('Relato enviado com sucesso!');
          reportForm.reset();
        });
      }
      // Exibe relatos locais ao carregar
      carregarRelatosPublicos();
    });

    // Função para carregar relatos públicos
    function carregarRelatosPublicos() {
      const relatosDiv = document.getElementById('relatos-publicos');
      if (!relatosDiv) return;
      if (!window.relatosLocais || window.relatosLocais.length === 0) {
        relatosDiv.innerHTML = '<div class="text-center text-muted">Nenhum relato enviado nesta sessão.</div>';
        // Limpa marcadores de relatos do mapa
        if (window.relatosMarkers && window.meuMapa) {
          window.relatosMarkers.forEach(m => window.meuMapa.removeLayer(m));
          window.relatosMarkers = [];
        }
        return;
      }
      let html = '';
      // Limpa marcadores antigos
      if (window.relatosMarkers && window.meuMapa) {
        window.relatosMarkers.forEach(m => window.meuMapa.removeLayer(m));
      }
      window.relatosMarkers = [];
      // Mapeia tipo para emoji
      const tipoEmoji = {
        'alagamento': '💧',
        'enxurrada': '🌊',
        'obstrucao': '🚧',
        'deslizamento': '⛰️',
        'fio-duvidoso': '⚡',
        'outro': '❓'
      };
      // Se houver relato "Sem água no momento" para o mesmo endereço, anula relatos anteriores de alagamento
      let relatosFiltrados = [];
      window.relatosLocais.forEach(function(r) {
        if (r.nivel === '0') {
          // Remove relatos anteriores de alagamento para o mesmo endereço
          relatosFiltrados = relatosFiltrados.filter(rel => rel.address !== r.address);
          relatosFiltrados.push(r);
        } else {
          // Só adiciona se não houver relato "Sem água" para o mesmo endereço
          if (!relatosFiltrados.some(rel => rel.address === r.address && rel.nivel === '0')) {
            relatosFiltrados.push(r);
          }
        }
      });
      relatosFiltrados.forEach(function(r) {
        const primario = r.ocorridoPrimario ? (tipoEmoji[r.ocorridoPrimario] || '❓') + ' ' + r.ocorridoPrimario : '';
        const secundario = r.ocorridoSecundario && r.ocorridoSecundario !== '' ? (tipoEmoji[r.ocorridoSecundario] || '❓') + ' ' + r.ocorridoSecundario : '';
        const emoji = r.nivel === '0' ? '✅' : (tipoEmoji[r.ocorridoPrimario] || '❓');
        html += `<div class="card mb-3"><div class="card-body">
          <h5 class="card-title">${emoji} ${r.nivel === '0' ? 'Sem água no momento' : (primario || 'Relato')}</h5>
          ${secundario ? `<div class='mb-1'><strong>Ocorrido Secundário:</strong> ${secundario}</div>` : ''}
          <p class="card-text"><strong>Endereço:</strong> ${r.address || 'Não informado'}</p>
          <p class="card-text"><strong>Nível da água:</strong> ${r.nivel === '0' ? 'Sem água no momento' : (r.nivel || '--')}</p>
          <p class="card-text"><strong>Descrição:</strong> ${r.descricao || ''}</p>
          <p class="card-text"><small class="text-muted">${new Date(r.dataHora).toLocaleString('pt-BR')}</small></p>
        </div></div>`;
        // Adiciona marcador no mapa com ícone personalizado e efeito 3D/pulso
        if (window.meuMapa && r.latitude && r.longitude && !isNaN(parseFloat(r.latitude)) && !isNaN(parseFloat(r.longitude))) {
          // Cor da borda do marcador conforme nível
          let nivelCor = '#38bdf8';
          if (r.nivel === '0') nivelCor = '#22c55e';
          else if (r.nivel === '0.2') nivelCor = '#38bdf8';
          else if (r.nivel === '0.5') nivelCor = '#fbbf24';
          else if (r.nivel === '1.0') nivelCor = '#f87171';
          else if (r.nivel === '1.5') nivelCor = '#dc2626';
          // Ícone com efeito 3D, sombra e animação de pulso
          const iconHtml = `
            <div class="relato-marker-3d" style="--cor:${nivelCor};">
              <span class="relato-marker-emoji">${emoji}</span>
              <span class="relato-marker-pulse"></span>
            </div>
            <style>
              .relato-marker-3d {
                position: relative;
                width: 44px; height: 44px;
                display: flex; align-items: center; justify-content: center;
                background: linear-gradient(145deg,#fff 60%,#e0f2fe 100%);
                border-radius: 50%;
                border: 3.5px solid var(--cor,#38bdf8);
                box-shadow: 0 6px 24px #2563eb33, 0 2px 12px #38bdf822, 0 0 0 6px #fff8;
                z-index: 2;
                animation: markerPop 0.7s cubic-bezier(.23,1.02,.32,1);
                transition: border 0.3s, box-shadow 0.3s;
              }
              .relato-marker-3d:hover {
                box-shadow: 0 12px 36px #2563eb55, 0 4px 16px #38bdf855, 0 0 0 10px #bae6fd55;
                transform: scale(1.08) translateY(-3px);
              }
              .relato-marker-emoji {
                font-size: 2.1rem;
                line-height: 1.1;
                z-index: 3;
                filter: drop-shadow(0 2px 8px #2563eb22);
                user-select: none;
              }
              .relato-marker-pulse {
                position: absolute;
                left: 50%; top: 50%;
                width: 44px; height: 44px;
                transform: translate(-50%,-50%);
                border-radius: 50%;
                background: radial-gradient(circle, var(--cor,#38bdf8) 0%, transparent 70%);
                opacity: 0.25;
                z-index: 1;
                animation: markerPulse 1.5s infinite cubic-bezier(.23,1.02,.32,1);
              }
              @keyframes markerPulse {
                0% { opacity: 0.25; transform: translate(-50%,-50%) scale(1); }
                60% { opacity: 0.12; transform: translate(-50%,-50%) scale(1.5); }
                100% { opacity: 0; transform: translate(-50%,-50%) scale(2.1); }
              }
              @keyframes markerPop {
                0% { transform: scale(0.7) translateY(20px); opacity: 0; }
                60% { transform: scale(1.1) translateY(-6px); opacity: 1; }
                100% { transform: scale(1) translateY(0); opacity: 1; }
              }
            </style>
          `;
          const customIcon = L.divIcon({
            className: '',
            html: iconHtml,
            iconSize: [48, 48],
            iconAnchor: [24, 44],
            popupAnchor: [0, -44]
          });
          const marker = L.marker([parseFloat(r.latitude), parseFloat(r.longitude)], {icon: customIcon, riseOnHover:true}).addTo(window.meuMapa);
          // Popup detalhado com efeito de entrada
          const primario = r.ocorridoPrimario ? (tipoEmoji[r.ocorridoPrimario] || '❓') + ' ' + r.ocorridoPrimario : '';
          const secundario = r.ocorridoSecundario && r.ocorridoSecundario !== '' ? (tipoEmoji[r.ocorridoSecundario] || '❓') + ' ' + r.ocorridoSecundario : '';
          const tipoTag = `<span style="display:inline-block;background:linear-gradient(90deg,#38bdf8 60%,#2563eb 100%);color:#fff;font-weight:600;font-size:0.98rem;padding:2px 10px;border-radius:1rem;margin-right:6px;box-shadow:0 2px 8px #2563eb22;letter-spacing:0.5px;">${emoji} ${r.nivel === '0' ? 'Sem água no momento' : (primario || 'Relato')}</span>`;
          const nivelTag = `<span style="display:inline-block;background:${nivelCor};color:#222;font-weight:600;font-size:0.97rem;padding:2px 10px;border-radius:1rem;margin-left:0;box-shadow:0 2px 8px #2563eb22;">${r.nivel === '0' ? 'Sem água no momento' : (r.nivel ? r.nivel.replace('0.2','Baixo').replace('0.5','Moderado').replace('1.0','Alto').replace('1.5','Grave') : '--')}</span>`;
          const popupHtml = `
            <div class="popup-anim" style="min-width:220px;max-width:320px;padding:13px 10px 10px 10px;border-radius:1.2rem;background:linear-gradient(120deg,#f0f9ff 60%,#bae6fd 100%);box-shadow:0 4px 24px #2563eb33,0 1.5px 12px #38bdf822;border:2.5px solid #38bdf8;position:relative;overflow:hidden;transition:box-shadow 0.3s;">
              <div style="position:absolute;inset:0;z-index:0;pointer-events:none;background:radial-gradient(ellipse 80% 40% at 60% 0%,#f9f87133 0%,#fbbf2433 40%,transparent 100%),radial-gradient(ellipse 60% 30% at 20% 20%,#5ee7df33 0%,#a5b4fc22 60%,transparent 100%),radial-gradient(ellipse 40% 20% at 80% 80%,#fca5a522 0%,transparent 100%);opacity:0.7;"></div>
              <div style="display:flex;align-items:center;gap:0.7rem;margin-bottom:0.7rem;z-index:1;position:relative;">
                <span style="font-size:2.3rem;line-height:1.1;display:inline-block;background:#fff;border-radius:50%;border:2.5px solid #38bdf8;box-shadow:0 2px 8px #2563eb33;padding:2px 13px 2px 13px;">${emoji}</span>
                <div style="display:flex;flex-direction:column;gap:2px;">
                  ${tipoTag}
                  ${nivelTag}
                </div>
              </div>
              ${secundario ? `<div style='font-size:1.07rem;margin-bottom:4px;z-index:1;position:relative;'><b>Ocorrido Secundário:</b> <span style='color:#222;'>${secundario}</span></div>` : ''}
              <div style="font-size:1.07rem;margin-bottom:4px;z-index:1;position:relative;"><i class='fas fa-map-marker-alt' style='color:#38bdf8;'></i> <b>Endereço:</b> <span style='color:#222;'>${r.address || 'Não informado'}</span></div>
              <div style="font-size:1.07rem;margin-bottom:4px;z-index:1;position:relative;"><b>Descrição:</b> <span style='color:#222;'>${r.descricao || ''}</span></div>
              <div style="font-size:0.97rem;color:#2563eb;margin-top:7px;text-align:right;z-index:1;position:relative;"><i class='far fa-clock' style='color:#38bdf8;'></i> ${new Date(r.dataHora).toLocaleString('pt-BR')}</div>
              <style>
                .leaflet-popup-content-wrapper { box-shadow: 0 8px 32px #2563eb33 !important; border-radius: 1.2rem !important; border: 2.5px solid #38bdf8 !important; }
                .leaflet-popup-content { margin: 0.5rem 0.2rem !important; }
                .popup-anim { animation: popupFadeIn 0.7s cubic-bezier(.23,1.02,.32,1); }
                @keyframes popupFadeIn {
                  0% { opacity: 0; transform: scale(0.92) translateY(30px); }
                  60% { opacity: 1; transform: scale(1.04) translateY(-8px); }
                  100% { opacity: 1; transform: scale(1) translateY(0); }
                }
                @media (max-width: 500px) {
                  .leaflet-popup-content { font-size: 0.97rem !important; }
                }
              </style>
            </div>
          `;
          marker.bindPopup(popupHtml);
          window.relatosMarkers.push(marker);
        }
      });
      relatosDiv.innerHTML = html;
    }
    // ...existing code...
  </script>
  <script>
  // Força updateAuthUI após login
  document.addEventListener('DOMContentLoaded', function() {
    if (window.auth && window.firebase && window.firebase.auth) {
      window.firebase.auth().onAuthStateChanged(function(user) {
        // updateAuthUI(user); // Removido, controle feito pelo script.js
      });
    } else if (window.auth && window.onAuthStateChanged) {
      window.onAuthStateChanged(window.auth, function(user) {
        // updateAuthUI(user); // Removido, controle feito pelo script.js
      });
    } else {
      var user = null;
      try {
        user = JSON.parse(localStorage.getItem('user')) || null;
      } catch {}
      // updateAuthUI(user); // Removido, controle feito pelo script.js
    }
  });
</script>
</body>
</html>
